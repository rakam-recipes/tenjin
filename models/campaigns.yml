version: 2

sources:
  - name: marketing
    tables:
      - name: campaigns
        description: Campaigns that users are attributed to, or campaigns from ad-networks API
        meta:
          hidden: true
        columns:
          - name: name
          - name: ad_network_id
            meta: &hidden
              rakam.dimension:
                hidden: true
          - name: campaign_bucket_id
            meta: *hidden
            tests:
              - relationships:
                  to: source('marketing', 'apps')
                  field: id
                  type: inner_join
                  relationship: many_to_one
              - relationships:
                  to: source('marketing', 'ad_networks')
                  field: ad_network_id
                  type: inner_join
                  relationship: many_to_one
              - relationships:
                  to: source('marketing', 'campaign_buckets')
                  field: id
                  relationship: one_to_one
                  type: inner_join

          - name: app_id
            meta: *hidden
          - name: ad_network_id
            meta: *hidden
